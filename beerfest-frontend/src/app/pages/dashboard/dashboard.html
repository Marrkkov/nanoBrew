<app-navbar></app-navbar>

<div class="grid">
  <!-- Panel principal -->
  <div class="card">
    <h2>{{ auth.username }} â€” Tus Cuentas</h2>

    @if (!isAdmin) {
      @for (it of items; track it.key) {
        <div class="row">
          <div>{{ it.label }}</div>
          <div class="btns">
            <button (click)="upd(it.key, -1)">â€“</button>
            <button (click)="upd(it.key, 1)">+</button>
          </div>
        </div>
      }
    } @else {
      <p class="muted">Este usuario no registra ventas. Usa el panel de administraciÃ³n para gestionar el evento.</p>
    }

    <div class="totals">
      <div class="grand">{{ totals.grand }}</div>
      <div class="muted">500: {{ totals.qty_500 }} | 250: {{ totals.qty_250 }} | Bottle: {{ totals.qty_bottle }}</div>
    </div>
  </div>

  <!-- Panel secundario -->
  <div class="card">
    <h2>Team & Admin</h2>
    <a routerLink="/overview" class="link">ðŸ‘€ Ver totales de todos</a>

    @if (isAdmin) {
      <div class="space"></div>
      <h3>Acciones de administrador</h3>
      <button class="btn btn--danger" (click)="resetAll()">Restablecer todos los valores a 0</button>
      <div class="muted">{{ resetMsg }}</div>

      <div class="space"></div>
      <details>
        <summary>Agregar cervecerÃ­a</summary>
        <form (ngSubmit)="addUser()" #fu="ngForm">
          <input name="nu" placeholder="nuevo usuario" [(ngModel)]="newU" required>
          <input name="np" placeholder="clave temporal" [(ngModel)]="newP" required>
          <button class="btn btn--primary">Agregar</button>
        </form>
        <small class="muted">{{ addMsg }}</small>
      </details>
    } @else {
      <div class="space"></div>
      <details>
        <summary>Cambiar mi contraseÃ±a</summary>
        <form (ngSubmit)="changePw()" #fp="ngForm">
          <input name="c" type="password" placeholder="actual" [(ngModel)]="curPw" required>
          <input name="n" type="password" placeholder="nueva (min 4)" [(ngModel)]="newPw" required>
          <button class="btn">Cambiar</button>
        </form>
        <small class="muted">{{ pwMsg }}</small>
      </details>
    }
  </div>
</div>
